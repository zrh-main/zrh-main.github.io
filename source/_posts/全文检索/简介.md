---
title: 简介
tags:
  - 全文检索
categories:
  - Java
---


## 前言
搜索: 
  入口:
    全文检索:

    分类检索:
    最终的检索页面信息:
      品牌:
      平台属性+ 平台属性值:
      库存单元基本数据: skuInfo
      分页:
      过滤:
      排序:
## 全文检索:
  站内搜索(全文检索):`指的是在自己系统的数据库中进行搜索`
https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html
## 查询: 
`模糊查询,如果你的数据库中的数据有几万条数据,不会影响查询速度,也不会影响客户体验度`	
员工表中姓张的员工都列出来
  select * from emp where ename like '张%'
  查询出员工表中名字中含有亮 
  select * from emp where ename like '%亮%'
    
如果数据量比较大, 超过百万条的数据, 必须使用站内搜索	
## 站内搜索常见技术
lucene,   solr,  `ElasticSearch`

## ElasticSearch简介
Elasticsearch 是搜索引擎;简称ES
Elasticsearch 是一个免费及开放（free and open）的项目
Elasticsearch 是一个分布式的基于 REST 接口的为云而设计的搜索引擎
Elasticsearch 是由 Elastic 公司创建
## ELK 软件栈
Elastic 公司拥有 Logstash,Kibana,Elasticsearch开源项目
这个三个项目组合在一起，就形成了 ELK 软件栈
他们三个共同形成了一个强大的生态圈
  - `Logstash 负责数据的采集，处理（丰富数据，数据转换等）`
  - `Kibana 负责数据展示，分析，管理，监督及应用`
  - `Elasticsearch 处于最核心的位置，它可以帮我们对数据进行快速地搜索及分析`
## ElasticSearch功能
Elasticsearch是一个基于 Apache Lucene （TM）的开源搜索引擎
无论在开源还是专有领域，Lucene 可以被认为是迄今为止最先进、性能最好的、功能最全的搜索引擎库
  - 一个完全用 Java 编写的搜索引擎库
  - 截止2005年，是一个顶级的 Apache 开源项目
  - 提供强大的全文搜索功能

## 索引
正排索引
倒排索引(ElasticSearch使用)

## 
Elasticsearch 类似于数据库(MySQL)

## 版本对比
- ES 7.0之前(ES 6.8.1)
  - Index   数据库
  - Type    表
  - Document  行
  - Field   列    数据库字段id,name...等
- ES 7.0之后,不再有Type列
  - Index   数据库
  - Document  行
  - Field   列    数据库字段id,name...等

## 使用时机
向应用或网站添加搜索框
存储和分析日志、指标和安全事件数据
使用机器学习实时自动建模数据行为
使用 Elasticsearch 作为存储引擎自动化业务工作流程
使用 Elasticsearch 作为地理信息系统 (GIS) 管理、集成和分析空间信息
使用 Elasticsearch 作为生物信息学研究工具来存储和处理遗传数据



Elasticsearch 是一个分布式文档存储。Elasticsearch 不是将信息存储为列式数据行，而是存储已序列化为 JSON 文档的复杂数据结构。当集群中有多个 Elasticsearch 节点时，存储的文档会分布在整个集群中，并且可以从任何节点立即访问

Elasticsearch 使用一种称为倒排索引的数据结构，它支持非常快速的全文搜索。倒排索引列出了出现在任何文档中的每个唯一单词，并标识了每个单词出现的所有文档。



索引可以被认为是文档的优化集合，每个文档都是字段的集合，字段是包含数据的键值对。默认情况下，Elasticsearch 索引每个字段中的所有数据，并且每个索引字段都有一个专用的优化数据结构。例如，文本字段存储在倒排索引中，而数字和地理字段存储在 BKD 树中。使用每个字段的数据结构来组装和返回搜索结果的能力是 Elasticsearch 如此快速的原因。

Elasticsearch 还具有无模式的能力，这意味着无需明确指定如何处理文档中可能出现的每个不同字段即可对文档进行索引。启用动态映射后，Elasticsearch 会自动检测新字段并将其添加到索引中。这种默认行为使索引和探索数据变得容易——只需开始索引文档，Elasticsearch 就会检测并将布尔值、浮点和整数值、日期和字符串映射到适当的 Elasticsearch 数据类型。

然而，最终，您比 Elasticsearch 更了解您的数据以及您希望如何使用它。您可以定义规则来控制动态映射并显式定义映射以完全控制字段的存储和索引方式。

定义自己的映射使您能够：

区分全文字符串字段和精确值字符串字段
执行特定语言的文本分析
优化字段以进行部分匹配
使用自定义日期格式
使用无法自动检测到 geo_point的数据类型geo_shape
为不同目的以不同方式索引同一字段通常很有用。例如，您可能希望将字符串字段索引为用于全文搜索的文本字段和用于排序或聚合数据的关键字字段。或者，您可以选择使用多个语言分析器来处理包含用户输入的字符串字段的内容。

在索引期间应用于全文字段的分析链也在搜索时使用。当您查询全文字段时，查询文本会在索引中查找术语之前进行相同的分析。

信息输出：搜索和分析编辑
虽然您可以将 Elasticsearch 用作文档存储并检索文档及其元数据，但真正的强大之处在于能够轻松访问基于 Apache Lucene 搜索引擎库构建的全套搜索功能。

Elasticsearch 提供了一个简单、连贯的 REST API，用于管理您的集群以及索引和搜索您的数据。出于测试目的，您可以直接从命令行或通过 Kibana 中的开发者控制台轻松提交请求。在您的应用程序中，您可以将 Elasticsearch 客户端 用于您选择的语言：Java、JavaScript、Go、.NET、PHP、Perl、Python 或 Ruby。

搜索您的数据编辑
Elasticsearch REST API 支持结构化查询、全文查询和将两者结合的复杂查询。结构化查询类似于您可以在 SQL 中构造的查询类型。例如，您可以搜索索引中的genderandage字段并按字段employee对匹配项进行排序hire_date。全文查询查找与查询字符串匹配的所有文档，并按相关性排序返回它们——它们与您的搜索词的匹配程度。

除了搜索单个术语之外，您还可以执行短语搜索、相似性搜索和前缀搜索，并获得自动完成建议。

有要搜索的地理空间或其他数字数据吗？Elasticsearch 在支持高性能地理和数字查询的优化数据结构中索引非文本数据。

您可以使用 Elasticsearch 全面的 JSON 样式查询语言 ( Query DSL ) 访问所有这些搜索功能。您还可以构建SQL 样式的查询以在 Elasticsearch 内本地搜索和聚合数据，而 JDBC 和 ODBC 驱动程序使广泛的第三方应用程序能够通过 SQL 与 Elasticsearch 进行交互。

分析您的数据编辑
Elasticsearch 聚合使您能够构建复杂的数据摘要，并深入了解关键指标、模式和趋势。聚合不仅可以找到众所周知的“大海捞针”，还可以让您回答以下问题：

大海捞针有多少？
针的平均长度是多少？
针的中位长度是多少，按制造商细分？
在过去的六个月中，每年有多少针被添加到大海捞针中？
您还可以使用聚合来回答更微妙的问题，例如：

您最受欢迎的针头制造商是什么？
是否有任何不寻常或异常的针团？
因为聚合利用了用于搜索的相同数据结构，所以它们也非常快。这使您能够实时分析和可视化您的数据。您的报告和仪表板会随着数据的变化而更新，因此您可以根据最新信息采取行动。

更重要的是，聚合与搜索请求一起运行。您可以在单个请求中同时对相同数据进行搜索、过滤结果和执行分析。由于聚合是在特定搜索的上下文中计算的，因此您不仅显示了所有 70 号针的计数，而且还显示了符合用户搜索条件的 70 号针的计数——例如，所有尺寸 70的不粘绣花针。

但是等等，还有更多编辑
想要自动分析您的时间序列数据？您可以使用 机器学习功能在数据中创建准确的正常行为基线并识别异常模式。通过机器学习，您可以检测：

与值、计数或频率的时间偏差相关的异常
统计稀有性
群体成员的异常行为


ElasticSearch 9200 9300 端口
9300端口： ES节点之间通讯使用

9200端口： ES节点 和 外部 通讯使用

 

9300是TCP协议端口号，ES集群之间通讯端口号

9200端口号，暴露ES RESTful接口端口号

``` yml
#集群名称,建议修改成自己的，防止误用默认集群
cluster.name: zxs-mtysj
#配置为本机IP，外网可以访问
network.host: 0.0.0.0
#配置访问端口
http.port: 9201

transport.tcp.port: 9301
```